<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nobita Email Test</title>
    <style>
        /* Aapki original dark theme CSS */
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #000a1a;
            color: #cdeaff;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            text-align: center;
        }
        .container {
            padding: 40px;
            border: 2px solid #00ffdd;
            border-radius: 12px;
            background-color: #001133;
            box-shadow: 0 0 16px #00ffdd50;
            max-width: 90%;
            width: 450px;
        }
        h1 {
            color: #ff3399;
            font-size: 2.2em;
            margin-bottom: 20px;
            text-transform: uppercase;
        }
        /* Form ke liye naye styles */
        input[type="email"] {
            width: 80%;
            padding: 12px;
            margin-top: 20px;
            border: 1px solid #00ffdd;
            background-color: #000814;
            color: #cdeaff;
            border-radius: 6px;
            font-size: 1.1em;
        }
        button {
            background-color: #00ffdd;
            color: #001133;
            border: none;
            padding: 12px 25px;
            font-size: 1.1em;
            font-weight: bold;
            border-radius: 6px;
            margin-top: 25px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        button:hover {
            box-shadow: 0 0 12px #00ffdd;
        }
        button:disabled {
            background-color: #555;
            cursor: not-allowed;
        }
        /* Status message ke liye */
        #status-message {
            margin-top: 20px;
            font-size: 1em;
            height: 20px; /* Taaki layout jump na kare */
        }
        .success { color: #92fe9d; }
        .error { color: #ff3399; }
    </style>
</head>
<body>
    <div class="container">
        <h1>NOBI BOT ðŸ‘¾</h1>
        <p>Send Test Email (via App Password)</p>
        
        <div>
            <input type="email" id="email-input" placeholder="Enter target email...">
        </div>
        
        <button id="send-button">Send Test Email</button>

        <p id="status-message"></p>
    </div>

    <script>
        const emailInput = document.getElementById('email-input');
        const sendButton = document.getElementById('send-button');
        const statusMessage = document.getElementById('status-message');

        sendButton.addEventListener('click', async () => {
            const email = emailInput.value;
            if (!email) {
                statusMessage.textContent = 'Please enter an email address.';
                statusMessage.className = 'error';
                return;
            }

            // Button disable karo aur status dikhao
            sendButton.disabled = true;
            sendButton.textContent = 'Sending...';
            statusMessage.textContent = '';
            statusMessage.className = '';

            try {
                // Backend API ko call karo
                const response = await fetch('/api/send-email', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email: email }),
                });

                const result = await response.json();

                if (response.ok && result.success) {
                    statusMessage.textContent = result.message;
                    statusMessage.className = 'success';
                } else {
                    // Server se error message dikhao
                    statusMessage.textContent = `Error: ${result.message}`;
                    statusMessage.className = 'error';
                }

            } catch (err) {
                console.error('Fetch Error:', err);
                statusMessage.textContent = 'Failed to connect to server.';
                statusMessage.className = 'error';
            }

            // Button ko wapas enable karo
            sendButton.disabled = false;
            sendButton.textContent = 'Send Test Email';
        });
    </script>
</body>
</html>
